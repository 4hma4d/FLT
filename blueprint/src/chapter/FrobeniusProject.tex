\chapter{A project: Frobenius elements}

\section{Introduction and goal}

I had thought that the existence of Frobenius elements was specific to the theory
of local and global fields, until Joel Riou pointed out
an extremely general result from from Bourbaki's Commutative Algebra
(Chapter V, Section 2, number 2, theorem 2, part (ii)). Before we state the
theorem, let us make a definition.

\begin{definition}
  \label{Pointwise.stabilizer.toGaloisGroup}
  \lean{Pointwise.stabilizer.toGaloisGroup}
  Let $G$ be a finite group acting (via ring isomorphisms) on a commutative ring $B$,
  and let $A$ be the subring of $G$-invariants. Let $Q$ be a prime ideal of $B$, whose
  pullback to $A$ is the prime ideal $P$. Let $L$ be the field of fractions
  of the integral domain $B/Q$, and let $K$ be the field of fractions
  of the subring $A/P$. Then $L$ is naturally a $K$-algebra.

  Now $G$ acts on $B$ so it acts on the ideals of $B$. Let $D_Q\subseteq G$ be the
  stabilizer of $Q$. For $g\in D_Q$ the action of $g$ on $B$ gives us an induced
  $A/P$-algebra isomorphism of $B/Q$ which extends to a $K$-algebra automorphism $\phi_g$ of $L$.
  This construction $g\mapsto \phi_g$ defines a group homomorphism from $D_Q$
  to $\Aut_K(L)$.
  \leanok
\end{definition}

The theorem we want in this project is
\begin{theorem}
  \label{MulAction.stabilizer_surjective_of_action}
  \lean{MulAction.stabilizer_surjective_of_action}
  \uses{Pointwise.stabilizer.toGaloisGroup}
  The map $g\mapsto \phi_g$ from $D_Q$ to $\Aut_K(L)$ defined above is surjective.
\end{theorem}

In particular, $\Aut_K(L)$ is finite, although we prove this along the way and not
as a corollary. What is so striking about this theorem to me is that the only finiteness hypothesis
is on the group $G$ which acts; there are no finiteness hypotheses on the rings at all.

Even though $G$ is finite, it is possible in this generality for the extension $L/K$ to be infinite!
An example in the exercises in Bourbaki (exercise 9 of number 2 above):
$B=\mathbb{F}_2[X_0,X_1,X_2,\ldots]$
is a polynomial ring in infinitely many variables and $G$ is cyclic of order 2 with
the generator acting on $B$ via $X_{2n}\mapsto X_{2n}+X_{2n+1}$ and $X_{2n+1}\mapsto X_{2n+1}$.
If $Q$ is the ideal generated by the $X_i$ then apparently $L/K$ is a radical extension of
infinite degree. What is true however is that $\Aut_K(L)$ is always finite, because
$L/K$ is normal and the maximal separable subextension is finite of degree at most $|G|$.

The goal of this project is to get this theorem into mathlib.

\section{Integrality of $(B/Q)/(A/P)$.}

The precise set-up we'll work in is the following. We fix $G$ a finite group acting
on $B$ a commutative ring, and we have another commutative ring $A$ such
that $B$ is an $A$-algebra and the image of $A$ in $B$ is precisely the $G$-invariant
elements of $B$. We don't need the map $A\to B$ to be injective so we don't assume this.

We start with a fundamental construction.

\begin{definition}
  \lean{MulSemiringAction.CharacteristicPolynomial.F}
  \label{MulSemiringAction.CharacteristicPolynomial.F}
  \leanok
  If $b\in B$ then define the \emph{characteristic polynomial}
  $F_b$ of $b$ to be $\prod_{g\in G}(X-g\cdot b)$.
\end{definition}

Note that $F_b$ is $G$-invariant, because acting by some $a\in G$
just permutes the order of the factors. Hence we can descend $F_b$
to a monic polynomial in $A[X]$. We will denote this polynomial by $M_b$
and we'll also call it the characteristic polynomial of $b$, even though
it's not even well-defined if the map $A\to B$ isn't injective.

\begin{definition}
  \lean{MulSemiringAction.CharacteristicPolynomial.M}
  \label{MulSemiringAction.CharacteristicPolynomial.M}
  \leanok
  $M_b$ in $A[X]$ is any monic degree $|G|$ polynomial whose
  image in $B[X]$ is $F_b$.
\end{definition}

\subsection{API for $M_b$.}

We record some properties of $F_b$. We assume throughout
that $B$ is nontrivial (we will be assuming that it
has a prime ideal $Q$ very soon)

%\begin{lemma} $F_b$ has degree $n$.
%\begin{lemma} Every element of $B$ is a root of a monic
%  polynomial of degree $|G|$ in $A[X]$.
%\end{lemma}
%\begin{proof} Define $F(X)=\prod_{g\in G}(X-g\cdot b)$. This polynomial
%  is easily checked to be $G$-invariant
%\begin{proof}
%  \proves{MulAction.stabilizer_surjective_of_action}
