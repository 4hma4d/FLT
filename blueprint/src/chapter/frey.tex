\chapter{The Frey Curve}

\section{Overview}

In the last chapter we explained how, given a counterexample to Fermat's Last Theorem we could construct a Frey curve, which is an elliptic curve with some interesting properties. Let $\rho:\GQ\to\GL_2(\Z/p\Z)$ be the representation on the $p$-torsion of this curve. In this chapter we discuss some basic properties of this representation, used both by Mazur to prove that $\rho$ cannot be reducible and by Wiles to prove that it can't be irreducible.

\section{Hardly ramified representations}

We make the following definition (this is not in the literature but it is a useful concept for us). We discuss the meaning of some of the concepts involved afterwards.

\begin{definition}\label{hardly_ramified} Let $p\geq5$ be a prime. A representation $\rho: \GQ\to \GL_2(\Z/p\Z)$ is said to be \emph{hardly ramified} if it satisfies the following four axioms:
  \begin{enumerate}
  \item $\det(\rho)$ is the mod $p$ cyclotomic character;
  \item $\rho$ is unramified outside $2p$;
  \item The semisimplification of the restriction of $\rho$ to $\Gal(\Qbar_2/\Q_2)$ is unramified.
  \item The restriction of $\rho$ to $\GQp$ comes from a finite flat group scheme;
  \end{enumerate}
\end{definition}

We are interested in hardly ramified representations for two reasons. One is that by using some very deep theorems, we will be able to prove that all hardly ramified representations are \emph{potentially modular}, which will give us our first foothold into the world of modular forms.

%\begin{theorem}\label{i_am_not_going_to_give_any_uses} A hardly ramified mod $p$ Galois representation $\rho:\GQ\to\GL_2(\Z/p\Z)$ is \emph{potentially automorphic}, becoming automorphic over a (possibly non-solvable) totally real Galois extension $F/\Q$ which is disjoint from the subfield cut out by the kernel of $\rho$.
%\end{theorem}
% Thm 5.3 Taylor notes
%\begin{proof}
%  This proof is deep. There are three major steps.
%
%  1) We first use Moret-Bailly's theorem to find an F and an F-point $A/F$ on a moduli space of elliptic curves with $p$-torsion $\rho$ and $\ell$-torsion induced from a certain character.
%
%  2) We then lift the character to characteristic zero, and prove that the resulting theta series is modular (using for example a converse theorem). We deduce that $A[\ell]$ is modular.
%
%  3) We now use a modularity lifting theorem (due to Wiles/Taylor/Khare-Wintenberger/Skinner-Wiles/who?) to deduce that $A$ is modular. We immediately deduce that $A[p]$ is modular as required.
%\end{proof}

The second reason is the theorem which we want to discuss in this section:

\begin{theorem}\label{frey_curve_hardly_ramified}\uses{hardly_ramified} If $\rho$ is the Galois representation on the $p$-torsion of the Frey curve coming from a Frey package $(a,b,c,p)$, then $\rho$ is hardly ramified.
\end{theorem}

The theorem will follow from the results below. The first three are valid for all elliptic curves, the rest are specific to Frey curves.

\begin{theorem}\label{p_torsion_2d} If $E$ is an elliptic curve over an algebraically closed field $K$ of characteristic $0$, then $E(K)[p]$ has size $p^2$.
\end{theorem}
\begin{proof}
  There are several proofs in the textbooks. The Lean code is forthcoming work of David Angdinata; it follows the approach with division polynomials, and it will be part of his PhD thesis.
\end{proof}

\begin{theorem}\label{Elliptic_curve_det_p_torsion} If $E$ is an elliptic curve over a field $K$ of characteristic zero, and $p$ is a prime, then the determinant of the 2-dimensional Galois representation $E[p]$ is the mod $p$ cyclotomic character.
\end{theorem}
\begin{proof}
  This presumably should be done via the Weil pairing. I have not yet put any thought into a feasible way to go about this.
\end{proof}

\begin{theorem}\label{Elliptic_curve_quotient} If $E$ is an elliptic curve over a field $K$ of characteristic zero, and $p$ is a prime, and if $C\subseteq E[p]$ is a Galois-stable
  subgroup of order $p$, then there's an elliptic curve ``''$E/C$'' over $K$ and an isogeny of elliptic curves $E\to E/C$ with kernel precisely $K$.
\end{theorem}
\begin{proof}
  Brian Conrad suggested the following approach, applicable as well for abelian schemes $A\to S$ over a base.  Let $G$ be a finite locally free $S$-subgroup of $A$, say $G$ with constant rank $n > 0$ by working locally on the base, so $G$ is contained in $A[n]$.  Then $n: A \to A$ is the fppf quotient of the source by $A[n]$, so it expresses $A$ as an $A[n]$-torsor over itself.  The problem of building $A/G$ as an abelian scheme is then seen to be the “same” as that of constructing the quotient of this $A[n]$-torsor by the G-action.

  In other words, the problem them becomes one having nothing specific to do with abelian schemes, at the cost of working over a base (such as the original target $A$) even when $S$ was the spectrum of a field in the application. The question is now: for a finite locally free commutative $S$-group $H$ and a closed locally free $S$-subgroup $G$, build a reasonable quotient $H/G$. One approach is to look at the Cartier dual $H^\vee\to G^\vee$, show that it's faithfully flat, and then deduce that the Cartier dual of the kernel of this map does the job. Note that one input for this proof is the claim that inclusions of Hopf algebras over fields are flat, proved nicely in Waterhouse’s book.
\end{proof}
\begin{theorem}\label{Frey_curve_j} If $(a,b,c,p)$ is a Frey package then the $j$-invariant of the corresponding Frey curve is $2^8(C^2-AB)^3/A^2B^2C^2$.
\end{theorem}
\begin{proof}
  Apply the explicit formula (presumably already in mathlib)
\end{proof}

\begin{definition}\label{Tate_curve} We will need the Tate uniformisation of an elliptic curve with
  multiplicative reduction. A good reference for this is Silverman's second book on elliptic curves.
\end{definition}


\begin{theorem}\label{Frey_curve_unramified} If $(a,b,c,p)$ is a Frey package and $\rho$ is the $p$-torsion in the corresponding Frey curve, then $\rho$ is unramified outside $2p$.
\end{theorem}
\begin{proof}
  If $\ell$ doesn't divide $pabc$ then the curve has good reduction at $\ell$ and hence the $p$-torsion is unramified at $\ell$.

  If however $2<\ell\ne p$ divides $abc$ then the curve has multiplicative reduction at $\ell$ and the $p$-torsion is unramified at $\ell$ by the theory of Tate uniformisation (this uses the fact that the $j$-invariant is a power of $p$ after an unramified extension).
\end{proof}

\begin{theorem}\label{Frey_curve_at_2} Let $\rho$ be the $p$-torsion in a $p$-Frey curve. Then the semisimplification of the restriction of $\rho$ to $\Gal(\Qbar_2/\Q_2)$ is unramified.
\end{theorem}
\begin{proof}
  Again this follows from the theory of Tate uniformisation, and the fact that the Frey curve has multiplicative reduction at 2.
\end{proof}

\begin{definition}\label{finite_flat_group_scheme} We will need a definition of finite flat group schemes over a base ring. I propose using Hopf algebras.
\end{definition}
  
\begin{theorem}\label{Frey_curve_finite_flat} Let $\rho$ be the $p$-torsion in a $p$-Frey curve. Then the restriction of $\rho$ to $\GQp$ comes from a finite flat group scheme.
\end{theorem}
\begin{proof} The Frey curve either has good reduction at $p$ (case 1 of FLT) or multiplicative reduction at $p$ (case 2 of FLT). In the first case the $p$-torsion is unramified at $p$ by general theory, and in the second case the $p$-torsion is (up to quadratic twist) an \emph{unramified} extension of the trivial character by the cyclotomic character.
\end{proof}

